<!-- Modal Overlay -->
<div class="modal-overlay" (click)="onClose()">
  <!-- Modal Content -->
  <div
    class="modal-content w-full h-full sm:rounded-2xl flex flex-col overflow-hidden"
    [class.sm:w-[1500px]]="dayConfig.challengeType !== 'geometryDash'"
    [class.sm:w-[80vw]]="dayConfig.challengeType === 'geometryDash'"
    [class.sm:max-w-[1400px]]="dayConfig.challengeType === 'geometryDash'"
    [class.sm:max-h-[90vh]]="dayConfig.challengeType !== 'geometryDash'"
    [class.sm:h-[90vh]]="dayConfig.challengeType === 'geometryDash'"
    (click)="$event.stopPropagation()"
  >
    <!-- Header with Close Button -->
    <div
      class="flex items-center justify-between mb-4 sm:mb-6 flex-shrink-0 sticky top-0 bg-surface z-10 py-1 sm:py-0 sm:static"
    >
      <h2 class="text-sm sm:text-3xl font-bold text-text">
        ğŸ„ {{ 'calendar.dayLabel' | translate : { day: dayConfig.day } }} ğŸ
      </h2>
      <button
        (click)="onClose()"
        class="btn btn-outline p-1 sm:p-2 min-w-0 text-xs sm:text-base"
        aria-label="Close"
      >
        <lucide-icon [img]="X" class="w-3 h-3 sm:w-6 sm:h-6" [strokeWidth]="2"></lucide-icon>
      </button>
    </div>

    <!-- Challenge Content Area -->
    @if (!showFunFact) {
    <div class="challenge-content flex-1 overflow-y-auto pb-4 sm:pb-0">
      <!-- Dynamic challenge component container -->
      <ng-container #challengeContainer></ng-container>

      <!-- Placeholder for unimplemented challenge types -->
      @if (!challengeContainer) {
      <div class="text-center py-12">
        <p class="text-lg text-text-muted mb-4">
          Challenge type: <span class="text-gold font-semibold">{{ dayConfig.challengeType }}</span>
        </p>
        <p class="text-sm text-text-muted">This challenge type is not yet implemented.</p>
      </div>
      }
    </div>
    } @else {
    <!-- Fun Fact Display -->
    <app-fun-fact-reveal
      [funFactKey]="dayConfig.funFactKey"
      (continue)="onCloseFunFact()"
    ></app-fun-fact-reveal>
    }
  </div>
</div>
