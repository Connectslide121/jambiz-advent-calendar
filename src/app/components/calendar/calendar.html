<div class="calendar-container">
  <!-- Calendar Grid -->
  <div class="grid grid-cols-3 sm:grid-cols-4 lg:grid-cols-6 gap-3 sm:gap-4 lg:gap-6">
    @for (dayConfig of calendarDays; track dayConfig.day) {
    <button
      class="day-tile card relative overflow-hidden transition-all duration-300"
      [class.completed]="isDayCompleted(dayConfig.day)"
      [class.unpopulated]="!dayConfig.challengeType"
      [class.hover:scale-105]="dayConfig.challengeType"
      [class.hover:shadow-xl]="dayConfig.challengeType"
      [disabled]="!dayConfig.challengeType"
      (click)="onDaySelected(dayConfig)"
      [attr.aria-label]="'Day ' + dayConfig.day"
    >
      <!-- Challenge Emoji - Tilted and Clipped -->
      @if (dayConfig.challengeType) {
      <div class="challenge-emoji" [class.grayscale]="!isDayCompleted(dayConfig.day)">
        {{ getChallengeEmoji(dayConfig.challengeType) }}
      </div>
      }

      <!-- Day Number -->
      <div class="day-number text-2xl sm:text-3xl lg:text-4xl font-bold text-gold mb-2">
        {{ dayConfig.day }}
      </div>

      <!-- Coming Soon Indicator -->
      @if (!dayConfig.challengeType) {
      <div class="text-xs sm:text-sm text-text-muted opacity-70 mt-1">
        {{ 'calendar.comingSoon' | translate }}
      </div>
      }

      <!-- Completion Indicator -->
      @if (isDayCompleted(dayConfig.day)) {
      <div class="absolute top-2 right-2 bg-accent-green rounded-full p-1.5">
        <lucide-icon
          [img]="Check"
          class="w-3 h-3 sm:w-4 sm:h-4 text-white"
          [strokeWidth]="3"
        ></lucide-icon>
      </div>
      }

      <!-- Hover Effect Overlay -->
      <div
        class="absolute inset-0 bg-accent-red opacity-0 hover:opacity-10 transition-opacity duration-300 pointer-events-none"
      ></div>
    </button>
    }
  </div>

  <!-- Challenge Modal -->
  @if (selectedDay) {
  <app-challenge-host
    [dayConfig]="selectedDay"
    [isCompleted]="isDayCompleted(selectedDay.day)"
    (close)="onCloseChallenge()"
    (challengeCompleted)="onChallengeCompleted()"
  ></app-challenge-host>
  }
</div>
