<div class="word-scramble-container">
  <!-- Title -->
  <div class="flex items-center justify-center gap-3 mb-3 sm:mb-4">
    <h3 class="text-xl sm:text-2xl font-bold text-gold text-center">
      ‚≠ê {{ 'challenges.wordScramble.title' | translate }} ‚≠ê
    </h3>
    <span
      *ngIf="isCompleted"
      class="bg-accent-green text-white text-xs px-2 py-1 rounded-full font-bold animate-in fade-in zoom-in flex items-center gap-1"
    >
      <lucide-icon [img]="Check" class="w-3 h-3" [strokeWidth]="4"></lucide-icon>
      {{ 'calendar.completed' | translate }}
    </span>
  </div>

  <!-- Instructions -->
  <p class="text-center text-text-muted mb-3 sm:mb-4">
    {{ 'challenges.wordScramble.instruction' | translate }}
  </p>

  <!-- Clue -->
  <div class="bg-bg rounded-lg p-3 sm:p-4 mb-3 sm:mb-4">
    <p class="text-sm text-text-muted mb-1 text-center">
      {{ 'challenges.wordScramble.clue' | translate }}
    </p>
    <p class="text-lg sm:text-xl text-text text-center italic">
      {{ config.clueKey | translate }}
    </p>
  </div>

  <!-- Scrambled Word Display -->
  <div class="bg-surface border-2 border-gold rounded-lg p-4 sm:p-6 mb-3 sm:mb-4">
    <div class="flex items-center justify-center gap-1.5 sm:gap-2 flex-wrap">
      @for (letter of scrambledWord.split(''); track $index) {
      <div
        class="w-10 h-10 sm:w-14 sm:h-14 flex items-center justify-center bg-bg border-2 border-gray-600 rounded-lg text-xl sm:text-3xl font-bold text-gold uppercase"
      >
        {{ letter }}
      </div>
      }
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="mb-3 sm:mb-4 flex items-center justify-center gap-3 flex-wrap">
    <button class="btn btn-outline text-sm flex items-center" (click)="reshuffleWord()">
      <lucide-icon [img]="ShuffleIcon" class="w-4 h-4 mr-2"></lucide-icon>
      {{ 'challenges.wordScramble.reshuffle' | translate }}
    </button>
    @if (config.hintKey) {
    <button class="btn btn-outline text-sm flex items-center" (click)="toggleHint()">
      <lucide-icon
        [img]="showHint ? LightbulbOffIcon : LightbulbIcon"
        class="w-4 h-4 mr-2"
      ></lucide-icon>
      {{
        (showHint ? 'challenges.wordScramble.hideHint' : 'challenges.wordScramble.showHint')
          | translate
      }}
    </button>
    }
  </div>
  @if (showHint && config.hintKey) {
  <div
    class="bg-accent-green bg-opacity-10 border border-accent-green rounded-lg p-3 sm:p-4 mb-3 sm:mb-4"
  >
    <p class="text-sm sm:text-base text-text text-center">üí° {{ config.hintKey | translate }}</p>
  </div>
  }

  <!-- Answer Input -->
  <div class="mb-3 sm:mb-4 max-w-96 mx-auto">
    <label for="scramble-answer" class="block text-sm font-medium text-text-muted mb-2">
      {{ 'challenges.wordScramble.answerLabel' | translate }}
    </label>
    <input
      id="scramble-answer"
      type="text"
      class="input"
      [(ngModel)]="userAnswer"
      (keypress)="onKeyPress($event)"
      [placeholder]="'challenges.wordScramble.placeholder' | translate"
      autocomplete="off"
    />
  </div>

  <!-- Error Message -->
  @if (showError) {
  <div class="mb-4 p-3 bg-accent-red bg-opacity-20 border border-accent-red rounded-lg">
    <p class="text-text text-center text-sm sm:text-base">
      ‚ùå {{ 'challenges.wordScramble.incorrect' | translate }}
    </p>
  </div>
  }

  <!-- Submit Button -->
  <div class="text-center flex flex-col sm:flex-row gap-3 justify-center">
    @if (!isCompleted) {
    <button
      class="btn btn-primary w-full sm:w-auto px-8"
      (click)="onSubmit()"
      [disabled]="!userAnswer.trim()"
    >
      {{ 'challenges.wordScramble.submit' | translate }}
    </button>
    } @else {
    <button class="btn btn-primary w-full sm:w-auto px-8" (click)="showReward()">
      {{ 'ui.showReward' | translate }}
    </button>
    <button class="btn btn-outline w-full sm:w-auto px-8" (click)="reset()">
      {{ 'ui.playAgain' | translate }}
    </button>
    }
  </div>
</div>
