<div class="quiz-container">
  <!-- Title -->
  <div class="flex items-center justify-center gap-3 mb-6">
    <h3 class="text-xl sm:text-2xl font-bold text-gold text-center">
      â“ {{ 'challenges.miniQuiz.title' | translate }} â“
    </h3>
    <span
      *ngIf="isCompleted"
      class="bg-accent-green text-white text-xs px-2 py-1 rounded-full font-bold animate-in fade-in zoom-in flex items-center gap-1"
    >
      <lucide-icon [img]="Check" class="w-3 h-3" [strokeWidth]="4"></lucide-icon>
      {{ 'calendar.completed' | translate }}
    </span>
  </div>

  <!-- Question -->
  <div class="bg-bg rounded-lg p-6 mb-6">
    <p class="text-lg sm:text-xl text-text leading-relaxed text-center">
      {{ config.questionKey | translate }}
    </p>
  </div>

  <!-- Options -->
  <div class="space-y-3 mb-6">
    @for (option of config.options; track $index) {
    <button
      class="w-full p-4 rounded-lg border-2 transition-all duration-200 text-left"
      [class.border-gray-600]="selectedOption !== $index && !showResult"
      [class.bg-surface]="selectedOption !== $index && !showResult"
      [class.hover:border-gold]="selectedOption !== $index && !showResult"
      [class.border-gold]="selectedOption === $index && !showResult"
      [class.bg-gold]="selectedOption === $index && !showResult"
      [class.bg-opacity-10]="selectedOption === $index && !showResult"
      [class.border-accent-green]="showResult && isCorrect && option.isCorrect"
      [class.bg-accent-green]="showResult && isCorrect && option.isCorrect"
      [class.bg-opacity-20]="showResult && isCorrect && option.isCorrect"
      [class.border-accent-red]="showResult && selectedOption === $index && !option.isCorrect"
      [class.bg-accent-red]="showResult && selectedOption === $index && !option.isCorrect"
      [class.bg-opacity-20]="showResult && selectedOption === $index && !option.isCorrect"
      [disabled]="showResult"
      (click)="selectOption($index)"
    >
      <div class="flex items-center justify-between">
        <span
          class="text-base sm:text-lg"
          [class.text-text]="selectedOption !== $index || showResult"
          [class.text-bg]="selectedOption === $index && !showResult"
          [class.font-semibold]="selectedOption === $index"
        >
          {{ option.textKey | translate }}
        </span>
        @if (showResult && isCorrect && option.isCorrect) {
        <span class="text-accent-green text-xl">âœ“</span>
        } @else if (showResult && selectedOption === $index && !option.isCorrect) {
        <span class="text-accent-red text-xl">âœ—</span>
        }
      </div>
    </button>
    }
  </div>

  <!-- Result Message -->
  @if (showResult) {
  <div
    class="mb-6 p-4 rounded-lg text-center border"
    [class.bg-accent-green]="isCorrect"
    [class.bg-opacity-20]="isCorrect"
    [class.border-accent-green]="isCorrect"
    [class.bg-accent-red]="!isCorrect"
    [class.bg-opacity-20]="!isCorrect"
    [class.border-accent-red]="!isCorrect"
  >
    <p class="font-semibold text-lg text-text">
      {{ isCorrect ? 'ğŸ‰ğŸ„' : 'âŒ' }}
      {{
        (isCorrect ? 'challenges.miniQuiz.correct' : 'challenges.miniQuiz.incorrect') | translate
      }}
    </p>
  </div>
  }

  <!-- Submit/Retry Button -->
  <div class="text-center">
    @if (!showResult) {
    <button
      class="btn btn-primary w-full sm:w-auto px-8"
      (click)="submitAnswer()"
      [disabled]="selectedOption === null"
    >
      {{ 'challenges.miniQuiz.submit' | translate }}
    </button>
    } @else if (!isCorrect) {
    <button class="btn btn-secondary w-full sm:w-auto px-8" (click)="reset()">
      {{ 'challenges.miniQuiz.tryAgain' | translate }}
    </button>
    } @else if (isCompleted) {
    <button class="btn btn-outline w-full sm:w-auto px-8" (click)="reset()">
      {{ 'ui.playAgain' | translate }}
    </button>
    }
  </div>
</div>
